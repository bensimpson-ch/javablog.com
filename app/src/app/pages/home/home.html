@if (authService.isAuthenticated) {
  <div class="author-actions">
    <a routerLink="/author/posts/new" class="btn btn-primary">
      <i class="fa-solid fa-plus" aria-hidden="true"></i>
      New Post
    </a>
  </div>
}

@if (loading()) {
  <div class="loading">Loading posts...</div>
}

@if (error()) {
  <div class="error">{{ error() }}</div>
}

@for (post of posts(); track post.id) {
  <article>
    <header>
      <div class="post-header">
        <h2><a [routerLink]="['/posts', post.slug]">{{ post.title }}</a></h2>
        @if (authService.isAuthenticated) {
          <div class="post-controls">
            <a [routerLink]="['/author/posts', post.id, 'edit']" class="btn-icon" title="Edit">
              <i class="fa-solid fa-pen" aria-hidden="true"></i>
            </a>
            <button
              (click)="confirmDelete(post)"
              class="btn-icon btn-danger"
              [disabled]="deleting() === post.id"
              title="Delete"
            >
              <i class="fa-solid fa-trash" aria-hidden="true"></i>
            </button>
          </div>
        }
      </div>
      <time [attr.datetime]="getDateOnly(post.createdAt)">{{ formatDate(post.createdAt) }}</time>
    </header>

    <p class="post-summary">{{ post.summary }}</p>
    <a [routerLink]="['/posts', post.slug]" class="read-more">Read more &rarr;</a>
  </article>
}

@if (lightboxImage()) {
  <div class="lightbox" (click)="closeLightbox()">
    <img [src]="lightboxImage()" alt="Enlarged view">
  </div>
}
